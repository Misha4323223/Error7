#!/usr/bin/env node

/**
 * ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ ÑĞµĞ¼Ğ°Ğ½Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ¹ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹
 * Ğ”Ğ¸Ğ°Ğ³Ğ½Ğ¾ÑÑ‚Ğ¸ĞºĞ° Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼ Ñ semantic-memory
 */

console.log('ğŸ” ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ ÑĞµĞ¼Ğ°Ğ½Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ¹ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹...\n');

async function checkSemanticSystemStatus() {
  try {
    // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ğ¼Ğ¾Ğ´ÑƒĞ»Ğ¸
    console.log('ğŸ“‹ ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ñ… Ğ¼Ğ¾Ğ´ÑƒĞ»ĞµĞ¹:');
    
    // 1. Ğ¡ĞµĞ¼Ğ°Ğ½Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ¿Ğ°Ğ¼ÑÑ‚ÑŒ
    try {
      console.log('   ğŸ§  Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµĞ¼ semantic-memory...');
      const semanticMemory = require('./server/semantic-memory/index.cjs');
      console.log('   âœ… semantic-memory Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾');
      
      // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ Ğ¸Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸
      if (semanticMemory.getModuleInitializationStatus) {
        const initStatus = semanticMemory.getModuleInitializationStatus();
        console.log('   ğŸ“Š Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ Ğ¸Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸:', {
          totalModules: Object.keys(initStatus.modules).length,
          loadedModules: Object.values(initStatus.modules).filter(m => m.loaded).length,
          cachedModules: Object.values(initStatus.modules).filter(m => m.cached).length
        });
      }
      
    } catch (error) {
      console.log('   âŒ ĞÑˆĞ¸Ğ±ĞºĞ° Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸ semantic-memory:', error.message);
    }
    
    // 2. Ğ˜Ğ½Ñ‚ĞµĞ»Ğ»ĞµĞºÑ‚ÑƒĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ñ€
    try {
      console.log('   ğŸ¯ Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµĞ¼ intelligent-chat-processor...');
      const intelligentProcessor = require('./server/intelligent-chat-processor.cjs');
      console.log('   âœ… intelligent-chat-processor Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾');
      
      // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ checkHealth ĞµÑĞ»Ğ¸ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½
      if (intelligentProcessor.checkHealth) {
        const health = intelligentProcessor.checkHealth();
        console.log('   ğŸ’š Ğ¡Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ Ğ·Ğ´Ğ¾Ñ€Ğ¾Ğ²ÑŒÑ:', health);
      }
      
    } catch (error) {
      console.log('   âŒ ĞÑˆĞ¸Ğ±ĞºĞ° Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸ intelligent-processor:', error.message);
    }
    
    // 3. Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ°
    try {
      console.log('   ğŸ“Š Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµĞ¼ semantic-healthcheck...');
      const healthCheck = require('./server/semantic-healthcheck.cjs');
      console.log('   âœ… semantic-healthcheck Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾');
      
    } catch (error) {
      console.log('   âŒ ĞÑˆĞ¸Ğ±ĞºĞ° Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸ healthcheck:', error.message);
    }
    
    // 4. Visual-semantic Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ñ
    try {
      console.log('   ğŸ¨ Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµĞ¼ visual-semantic-extensions...');
      const visualExtensions = require('./server/semantic-memory/visual-semantic-extensions.cjs');
      console.log('   âœ… visual-semantic-extensions Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾');
      
      const healthStatus = visualExtensions.checkHealth();
      console.log('   ğŸ¨ Ğ¡Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ visual-semantic:', healthStatus.system_status);
      
    } catch (error) {
      console.log('   âŒ ĞÑˆĞ¸Ğ±ĞºĞ° Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸ visual-semantic:', error.message);
    }
    
    console.log('\nğŸ” Ğ”Ğ¸Ğ°Ğ³Ğ½Ğ¾ÑÑ‚Ğ¸ĞºĞ° Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼:');
    
    // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¸Ñ‡Ğ¸Ğ½Ñ‹ degraded ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ
    console.log('   ğŸ” Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¸Ñ‡Ğ¸Ğ½Ñ‹ degraded ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ semantic-memory:');
    console.log('   1. ĞĞµ Ğ²ÑĞµ Ğ¼Ğ¾Ğ´ÑƒĞ»Ğ¸ Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ñ‹ ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ¾');
    console.log('   2. ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹ Ñ ĞºÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸ĞµĞ¼ Ğ¼Ğ¾Ğ´ÑƒĞ»ĞµĞ¹');
    console.log('   3. ĞÑˆĞ¸Ğ±ĞºĞ¸ Ğ² Ñ†Ğ¸ĞºĞ»Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ÑÑ…');
    console.log('   4. ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹ Ñ Ğ¸Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸ĞµĞ¹ Ğ½Ğ¾Ğ²Ñ‹Ñ… Ğ¼Ğ¾Ğ´ÑƒĞ»ĞµĞ¹');
    
    console.log('\nğŸ’¡ Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ğ¾ Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ:');
    console.log('   âœ… ĞŸĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ ÑĞ¸ÑÑ‚ĞµĞ¼Ñƒ ÑĞµĞ¼Ğ°Ğ½Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ¹ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸');
    console.log('   âœ… ĞÑ‡Ğ¸ÑÑ‚Ğ¸Ñ‚ÑŒ ĞºÑÑˆ Ğ¼Ğ¾Ğ´ÑƒĞ»ĞµĞ¹');
    console.log('   âœ… ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ²ÑĞµ ÑĞºÑĞ¿Ğ¾Ñ€Ñ‚Ñ‹ Ğ¼Ğ¾Ğ´ÑƒĞ»ĞµĞ¹');
    console.log('   âœ… Ğ£Ğ±ĞµĞ´Ğ¸Ñ‚ÑŒÑÑ Ñ‡Ñ‚Ğ¾ visual-semantic-extensions ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ¾ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½');
    
    return true;
    
  } catch (error) {
    console.error('âŒ ĞšÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ¾ÑˆĞ¸Ğ±ĞºĞ° Ğ´Ğ¸Ğ°Ğ³Ğ½Ğ¾ÑÑ‚Ğ¸ĞºĞ¸:', error.message);
    return false;
  }
}

// Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ´Ğ¸Ğ°Ğ³Ğ½Ğ¾ÑÑ‚Ğ¸ĞºĞ¸
checkSemanticSystemStatus()
  .then(success => {
    if (success) {
      console.log('\nğŸ¯ Ğ”Ğ¸Ğ°Ğ³Ğ½Ğ¾ÑÑ‚Ğ¸ĞºĞ° Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ°');
      console.log('ğŸ“‹ Ğ¡Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ: intelligent-processor Ğ·Ğ´Ğ¾Ñ€Ğ¾Ğ², semantic-memory Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ Ğ²Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ñ');
      console.log('ğŸ”§ Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ÑÑ Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑĞº ÑĞµĞ¼Ğ°Ğ½Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ¹ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹');
    } else {
      console.log('\nğŸ’¥ Ğ”Ğ¸Ğ°Ğ³Ğ½Ğ¾ÑÑ‚Ğ¸ĞºĞ° Ğ½Ğµ ÑƒĞ´Ğ°Ğ»Ğ°ÑÑŒ');
    }
  })
  .catch(error => {
    console.error('\nğŸ’¥ ĞÑˆĞ¸Ğ±ĞºĞ°:', error.message);
  });